swagger: '2.0'
info:
  title: Funance Microservice
  description: >-
    This is the Funance microservice
  version: 0.0.1
  contact:
    name: IMY 772
    email: u13080432@tuks.co.za
schemes:
  - http
  - https
tags:
  - name: profile
    description: Functions relating to a specific users profile
  - name: budget
    description: Functions relating to a specific users budget
  - name: savings
    description: Functions relating to a specific users savings
  - name: gameboard
    description: Functions relating to a specific users game state
basePath: /funance-msrv
paths:
  profile:
    get:
      tags:
      - profile
      summary: Retrieves profile of the requested user
      responses:
        '200':
          description: Profile of the logged in user
          schema:
            $ref: "#/definitions/ProfileResponse"
    post:
      tags:
      - profile
      summary: Creates a new profile for a user

  profile/dashboard:
    get:
      tags:
      - profile
      summary: Retrieves users full dashboard and summarised items
      responses:
        '200':
          description: Retrieves users full dashboard and summarised items
          schema:
            $ref: "#/definitions/DashboardResponse"

# Budget endpoints
  profile/budget:
    get:
      tags:
      - budget
      summary: Retrieves users full budget
      parameters:
      - in: query
        name: username
        required: true
        description: username
        type: string
      responses:
        '200':
          description: Budget of the logged in user
          schema:
            $ref: "#/definitions/BudgetResponse"
    post:
      tags:
      - budget
      summary: Captures the basic budget information
      parameters:
      - in: body
        name: body
        required: true
        description: Income and savings
        schema:
          $ref: '#/definitions/CaptureBudgetRequest'
      responses:
        '204':
          description: The budget basics were captured

  profile/budget/item:
    get:
      tags:
      - budget
      summary: Retrieves a specific budget item
      parameters:
      - in: query
        name: itemId
        required: true
        description: itemId
        type: integer
        format: int64
      responses:
        '200':
          description: Budget item chosen by the user
          schema:
            $ref: "#/definitions/BudgetItem"
    post:
      tags:
      - budget
      summary: Creates a new budget item
      parameters:
      - in: body
        name: body
        required: true
        description: Details for the item to create
        schema:
          $ref: '#/definitions/CreateBudgetItemRequest'
      responses:
        '200':
          description: The budget item that was created
          schema:
            $ref: "#/definitions/BudgetItem"

  profile/budget/item/capture:
    post:
      tags:
      - budget
      summary: Captures a sub item on a budget item
      parameters:
      - in: body
        name: body
        required: true
        description: Details for the sub item to create
        schema:
          $ref: '#/definitions/CaptureBudgetItemRequest'
      responses:
        '204':
          description: The budget item that was created
    put:
      tags:
      - budget
      summary: Marks items as complete
      parameters:
      - in: query
        name: itemId
        required: true
        description: Id of the item
        type: integer
        format: int64
      - in: query
        name: state
        required: true
        description: State of the item
        type: String
      responses:
        '204':
          description: The budget items state was updated


# Savings endpoints
  profile/savings:
    get:
      tags:
      - savings
      summary: Retrieve the full savings information
      responses:
        '200':
          description: The savings of the user
          schema:
            $ref: "#/definitions/SavingsResponse"

  profile/savings/threshold:
    post:
      tags:
      - savings
      summary: Capture your savings threshold
      parameters:
      - in: body
        name: body
        required: true
        description: Threshold amount
        schema:
          $ref: '#/definitions/SavingsThresholdRequest'
      responses:
        '204':
          description: Confirmation is was saved correctly

  profile/savings/goal:
    post:
      tags:
      - savings
      summary: Retrieve the full savings information
      parameters:
      - in: path
        name: goalType
        required: true
        description: Goal type to be captured
        schema:
          $ref: '#/definitions/SavingsGoalRequest'
      responses:
        '204':
          description: Confirmation that savings goal was saved

# Gameboard endpoints
  profile/gameboard:
    get:
      tags:
      - gameboard
      summary: Retrieve the full game state of the
      parameters:
      - in: query
        name: username
        required: true
        description: name of the user
        type: String
      responses:
        '200':
          description: The game state of the user
          schema:
            $ref: "#/definitions/GameboardResponse"

  profile/gameboard/item:
    post:
      tags:
      - gameboard
      summary: Buy a gameboard item
      parameters:
      - in: body
        name: body
        required: true
        description: Details for item bought
        schema:
          $ref: '#/definitions/BuyGameItemRequest'
      responses:
        '200':
          description: The updated game state of the user
          schema:
            $ref: "#/definitions/GameboardResponse"

definitions:
  ProfileResponse:
    type: object
    properties:
      name:
        type: string
      surname:
        type: string
      coins:
        type: integer
      session:
        type: string

  DashboardResponse:
    type: object
    properties:
      gameboard:
        $ref: "#/definitions/GameboardSummary"
      budget:
        $ref: "#/definitions/BudgetSummary"
      finance:
        $ref: "#/definitions/FinanceSummary"

  GameboardSummary:
    type: object
    properties:
      returnCode:
        type: integer

  BudgetSummary:
    type: object
    properties:
      returnCode:
        type: integer

  FinanceSummary:
    type: object
    properties:
      returnCode:
        type: integer
      savings:
        type: number
      budget:
        type: integer
      debt:
        type: integer

  BudgetResponse:
    type: object
    properties:
      categories:
        type: array
        items:
          $ref: '#/definitions/CategoryList'
      progress:
        type: integer
      amountComplete:
        type: integer
      amountTotal:
        type: integer
      daysLeftThisMonth:
        type: string
      outstandingPaymentAmount:
        type: number
      income:
        type: number

  CategoryList:
    type: object
    properties:
      category:
        $ref: '#/definitions/Category'
      budget:
        type: array
        items:
          $ref: '#/definitions/BudgetItem'

  BudgetItem:
    type: object
    properties:
      itemId:
        type: integer
        format: int64
      title:
        type: string
      onceoff:
        type: boolean
      category:
        $ref: '#/definitions/Category'
      categoryCustom:
        type: string
      description:
        type: string
      state:
        type: string
        enum:
          - OPEN
          - PAYED
          - UPCOMING
          - ERROR
      amount:
        type: number
        format: float
      date:
        type: string

  CaptureBudgetRequest:
    type: object
    properties:
      username:
        type: string
      income:
        type: number
      savings:
        type: number
      investments:
        type: number

  CreateBudgetItemRequest:
    type: object
    properties:
      username:
        type: string
      title:
        type: string
      description:
        type: string
      onceoff:
        type: boolean
      category:
        type: string
        enum:
        - DEBIT_ORDER
        - FOOD
        - MISC
        - CUSTOM
      categoryCustom:
        type: string
      amount:
        type: number
        format: float
      date:
        type: string

  CaptureBudgetItemRequest:
    type: object
    properties:
      title:
        type: string
      value:
        type: number
      date:
        type: string

  SavingsResponse:
    type: object
    properties:
      value:
        type: number
      projections:
        type: array
        items:
          $ref: '#/definitions/SavingsProjection'

  SavingsProjection:
    type: object
    properties:
      value:
        type: number
      projectionPeriod:
        type: string
        enum:
          - SIX_MONTHS
          - ONE_YEAR
          - TWO_YEARS

  SavingsThresholdRequest:
    type: object
    properties:
      value:
        type: number

  SavingsGoalRequest:
    type: object
    properties:
      value:
        type: number
      goalType:
        type: string
        enum:
          - SHORT_TERM
          - LONG_TERM

  GameboardResponse:
    type: object
    properties:
      coin:
        type: integer
        format: int64
      items:
        type: array
        items:
          $ref: '#/definitions/GameboardItem'
      environment:
        type: string
        enum:
          - SMALL
          - MEDIUM
          - LARGE

  GameboardItem:
    type: object
    properties:
      name:
        type: string
      itemType:
        $ref: '#/definitions/GameItemType'

  BuyGameItemRequest:
    type: object
    properties:
      itemType:
        $ref: '#/definitions/GameItemType'

  TwilioItem:
    type: object
    properties:
      twilio:
        $ref: '#/definitions/collected_items'

  twilio:
    type: object
    properties:
      twilio:
        $ref: '#/definitions/collected_items'

  collected_items:
    type: object
    properties:
      collected_data:
        $ref: '#/definitions/collect_comments'

  collect_comments:
    type: object
    properties:
      collected_data:
        $ref: '#/definitions/answers'

  answers:
    type: object
    properties:
      title:
        type: String
      category:
        type: String
      value:
        type: String

  GameItemType:
    type: string
    enum:
    - SMALL_PLANT
    - MEDIUM_PLANT
    - BIG_PLANT

  Category:
    type: string
    enum:
    - DEBIT_ORDER
    - FOOD
    - MISC
    - CUSTOM